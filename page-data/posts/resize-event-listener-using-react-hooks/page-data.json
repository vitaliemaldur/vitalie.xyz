{"componentChunkName":"component---src-templates-post-template-js","path":"/posts/resize-event-listener-using-react-hooks","result":{"data":{"markdownRemark":{"id":"42c9238e-1819-5719-aac0-6a7ddc30b5b0","html":"<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 960px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/4dc6ec9cbda6f591e6af2f153a1a3c2d/21b4d/programmer.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 69.453125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAOCAIAAACgpqunAAAACXBIWXMAAAsSAAALEgHS3X78AAACNElEQVQoz11Sy27TQBT1b9LCDhbsQZBKSFRdhLKoWCJEEZUoECIV4jSoxHnYiZ9je8Yev59JFyhI/AQnTlqiSkfW9dw559577ggsLU0/Btw4R3wHJEgMP7J4gguGFyE2eYzDTVawo2zucpySIPWyCrhlIkZqqJKJReeuLxOGXwg5N2UEK0imhEFVpVz3QoAmxa0E2pk5/szxQENBnte76gLSGgtUGiCNgIQphAG3kYAWUoCGC46/0W3QkFFQtphie+hKw1WXNwSuNqVmtjcybMVmOgvmlK+lowyT4osCApwYm46kkyvVHBuO4ni4AcAFL6+DcjkxXZxjtCmhZmOY2VgIjwRooKZss/WXMGj5+XoqXiwklfTHM9yztp7HNz1vIegsHOk2hBGAuV1DUrBscfTiSfvw6YR4Q42gO9miLC12FynAAxQcGQ7SmBwN42SdK65XmfInkWY0lAlWxTHqrtVb8tSiE8sFQMY+7TD1s2qgscufXUX63IVqmNpRyrK7T0hgSQka+JJuwy2Mt/Hz7PvVaVc8u+i/7YgDxcAWnWi9Pzf537kA09ASCiKNkaJqGVZLL8mrJC3juIiiRZrOCUODPKvCchEUNWK6IaMONqFRLk7U7lDpK0ZPNgaysarrVVX+Lou/18tz8denS0mUjb5iDuaWn9d4ajRB23jDaXU+GD88PNlvte8fHN971n708uTdl4sPnd5pp/f+64/HR2/2Wu0HB8f7rVd7z9uvP35DSRD/AdahmKnmGocgAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n        <source\n          srcset=\"/static/4dc6ec9cbda6f591e6af2f153a1a3c2d/8ac56/programmer.webp 240w,\n/static/4dc6ec9cbda6f591e6af2f153a1a3c2d/d3be9/programmer.webp 480w,\n/static/4dc6ec9cbda6f591e6af2f153a1a3c2d/e46b2/programmer.webp 960w,\n/static/4dc6ec9cbda6f591e6af2f153a1a3c2d/af3f0/programmer.webp 1280w\"\n          sizes=\"(max-width: 960px) 100vw, 960px\"\n          type=\"image/webp\"\n        />\n        <source\n          srcset=\"/static/4dc6ec9cbda6f591e6af2f153a1a3c2d/8ff5a/programmer.png 240w,\n/static/4dc6ec9cbda6f591e6af2f153a1a3c2d/e85cb/programmer.png 480w,\n/static/4dc6ec9cbda6f591e6af2f153a1a3c2d/d9199/programmer.png 960w,\n/static/4dc6ec9cbda6f591e6af2f153a1a3c2d/21b4d/programmer.png 1280w\"\n          sizes=\"(max-width: 960px) 100vw, 960px\"\n          type=\"image/png\"\n        />\n        <img\n          class=\"gatsby-resp-image-image\"\n          src=\"/static/4dc6ec9cbda6f591e6af2f153a1a3c2d/d9199/programmer.png\"\n          alt=\"Resize event listener using React hooks\"\n          title=\"Resize event listener using React hooks\"\n          loading=\"lazy\"\n          style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        />\n      </picture>\n  </a>\n    </span></p>\n<p>A couple of weeks ago while I was working on a small <strong>React</strong> project I had to implement some custom logic for the scenario when the user resizes the browser window.</p>\n<p>The usual <strong>Javascript</strong> solution looks like this.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'resize'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// your custom logic</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>This one can be used successfully, but it is not looking very good in a <strong>React</strong> app. So I decided to implement it differently using a more familiar approach for <strong>React</strong> developers, called <strong>hooks</strong>. Hooks are functions that let you “hook into” <strong>React</strong> state and lifecycle features from function components.</p>\n<p>A <strong>hook</strong> that will return the window width and update it when it changes can look like this.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> useState<span class=\"token punctuation\">,</span> useEffect <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">getWidth</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> window<span class=\"token punctuation\">.</span>innerWidth\n  <span class=\"token operator\">||</span> document<span class=\"token punctuation\">.</span>documentElement<span class=\"token punctuation\">.</span>clientWidth\n  <span class=\"token operator\">||</span> document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>clientWidth<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">useCurrentWitdh</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// save current window width in the state object</span>\n  <span class=\"token keyword\">let</span> <span class=\"token punctuation\">[</span>width<span class=\"token punctuation\">,</span> setWidth<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token function\">getWidth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// in this case useEffect will execute only once because</span>\n  <span class=\"token comment\">// it does not have any dependencies.</span>\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">resizeListener</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// change width from the state object</span>\n      <span class=\"token function\">setWidth</span><span class=\"token punctuation\">(</span><span class=\"token function\">getWidth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// set resize listener</span>\n    window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'resize'</span><span class=\"token punctuation\">,</span> resizeListener<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// clean up function</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// remove resize listener</span>\n      window<span class=\"token punctuation\">.</span><span class=\"token function\">removeEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'resize'</span><span class=\"token punctuation\">,</span> resizeListener<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">return</span> width<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>I used <strong>useState</strong> hook to keep window width value in the state object and <strong>useEffect</strong> to add a listener for the <strong>resize</strong> event.</p>\n<p>There is one more thing to mention, <strong>resize</strong> event it is triggered multiple times while the user is actively dragging the browser’s window resize handle, it may affect the performance of your application if you have a complex logic in the <strong>resize</strong> listener. One way to deal with it is to implement some debounce mechanism that will limit the rate at which a function can fire.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> useState<span class=\"token punctuation\">,</span> useEffect <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">getWidth</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> window<span class=\"token punctuation\">.</span>innerWidth\n  <span class=\"token operator\">||</span> document<span class=\"token punctuation\">.</span>documentElement<span class=\"token punctuation\">.</span>clientWidth\n  <span class=\"token operator\">||</span> document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span>clientWidth<span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">useCurrentWitdh</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// save current window width in the state object</span>\n  <span class=\"token keyword\">let</span> <span class=\"token punctuation\">[</span>width<span class=\"token punctuation\">,</span> setWidth<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token function\">getWidth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// in this case useEffect will execute only once because</span>\n  <span class=\"token comment\">// it does not have any dependencies.</span>\n  <span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// timeoutId for debounce mechanism</span>\n    <span class=\"token keyword\">let</span> timeoutId <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">resizeListener</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// prevent execution of previous setTimeout</span>\n      <span class=\"token function\">clearTimeout</span><span class=\"token punctuation\">(</span>timeoutId<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token comment\">// change width from the state object after 150 milliseconds</span>\n      timeoutId <span class=\"token operator\">=</span> <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">setWidth</span><span class=\"token punctuation\">(</span><span class=\"token function\">getWidth</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token number\">150</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// set resize listener</span>\n    window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'resize'</span><span class=\"token punctuation\">,</span> resizeListener<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// clean up function</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// remove resize listener</span>\n      window<span class=\"token punctuation\">.</span><span class=\"token function\">removeEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'resize'</span><span class=\"token punctuation\">,</span> resizeListener<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">return</span> width<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>How this debounce mechanism works? At every <strong>resize</strong> event fired, we delay the changing of the state object with 150 milliseconds, in case that another <strong>resize</strong> event gets fired before, it will prevent the previous change of the state to happen. In other words, the change of the state can happen only once every 150 milliseconds. More about this technique you can read on <a href=\"https://davidwalsh.name/javascript-debounce-function\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">David Walsh blog</a>.</p>\n<p>Example of how to use this hook in a <strong>React</strong> component.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">App</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> width <span class=\"token operator\">=</span> <span class=\"token function\">useCurrentWitdh</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>h1<span class=\"token operator\">></span>\n        <span class=\"token punctuation\">{</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Current width -> </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>width<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">}</span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h1<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Complete source code can be found <a href=\"https://github.com/vitaliemaldur/react-breakpoints-hook\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">here</a>. Feedback is much appreciated.</p>","fields":{"slug":"/posts/resize-event-listener-using-react-hooks","tagSlugs":["/tag/react/","/tag/npm/","/tag/javascript/","/tag/tutorial/","/tag/react-hooks/"]},"frontmatter":{"date":"2020-01-09","description":"A couple of weeks ago while I was working on a small React project I had to implement some custom logic for the scenario when the user resizes the browser window.","tags":["react","npm","javascript","tutorial","react-hooks"],"title":"Resize event listener using React hooks","socialImage":"/media/programmer.png"}}},"pageContext":{"slug":"/posts/resize-event-listener-using-react-hooks"}}}